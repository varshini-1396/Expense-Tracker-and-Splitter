<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoneyMate - Events</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="logo">MoneyMate</div>
        <div class="nav-links">
            <a href="{{ url_for('index') }}">Home</a>
            <a href="{{ url_for('events_page') }}" class="active">Events</a>
            <a href="{{ url_for('stats') }}">Stats</a>
            <a href="{{ url_for('groups_page') }}">Groups</a>
            <a href="{{ url_for('profile_page') }}">Profile</a>
        </div>
    </nav>

    <main>
        <div class="events-header">
            <h1>Events</h1>
            <button class="new-event-btn" onclick="showEventModal()">+ New Event</button>
        </div>

        <div class="events-list">
            <table>
                <thead>
                    <tr>
                        <th>Event</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody id="events-table">
                    <!-- Events will be loaded dynamically -->
                </tbody>
            </table>
        </div>
    </main>
    
    <!-- Event Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <h2>Add New Event</h2>
            <form id="event-form">
                <div class="form-group">
                    <label for="event-name">Event Name</label>
                    <input type="text" id="event-name" required>
                </div>
                <div class="form-group">
                    <label for="event-date">Date</label>
                    <input type="date" id="event-date" required>
                </div>
                <div class="modal-buttons">
                    <button type="button" onclick="closeEventModal()">Cancel</button>
                    <button type="submit">Add</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Load events on page load
        document.addEventListener('DOMContentLoaded', loadEvents);

        function loadEvents() {
            fetch('/api/events')
                .then(response => response.json())
                .then(events => {
                    updateEventsList(events);
                });
        }

        function updateEventsList(events) {
            const tbody = document.getElementById('events-table');
            tbody.innerHTML = '';
            
            events.forEach(e => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${e.name}</td>
                    <td>${new Date(e.date).toLocaleDateString()}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function showEventModal() {
            document.getElementById('event-modal').style.display = 'flex';
            
            const form = document.getElementById('event-form');
            form.onsubmit = (e) => {
                e.preventDefault();
                addEvent();
            };
        }

        function closeEventModal() {
            document.getElementById('event-modal').style.display = 'none';
        }

        function addEvent() {
            const name = document.getElementById('event-name').value;
            const date = document.getElementById('event-date').value;

            fetch('/api/events', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    name: name,
                    date: date
                })
            })
            .then(response => response.json())
            .then(() => {
                closeEventModal();
                loadEvents();
                document.getElementById('event-form').reset();
            });
        }
    </script>
</body>
</html> 